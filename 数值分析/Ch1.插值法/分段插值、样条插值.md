单一的插值或许可以拟合一些较为符合多项式空间下的插值问题，但是在多数情况下，插值问题与Sliding Window有类似的求解，即切块得到更好的解决方案
# Runge现象

有些问题本身就是病态的，以函数$y=1/(1+x)^2$为例，当求导过后，其在一点的值，其导数值会超阶乘级增长，这也就致使了其误差会不断增大。

而为了解决这一问题，多数的结局方案为分段，切割进行求解。

# 分段线性插值

即对一个区间内，进行子区间的切割，在端点处利用Lagrange插值进行求解
->其也是后续求解积分问题的一个重要思想
$$
P_1(x)=\frac{x-f(x_1)}{x_0-x_1}f(x_0)+\frac{x-f(x_0)}{x_1-x_0}f(x_0)
$$
# 分段Hermite插值

同样的，不过这里引入了导数的概念，与Hermite中两点三次保持一致：
$$H(x)=(1+2\frac{x-x_0}{x_1-x_0})(\frac{x-x_1}{x_0-x_1})^2y_0+(1+2\frac{x-x_1}{x_0-x_1})(\frac{x-x_0}{x_1-x_0})^2y_1+(x-x_0)(\frac{x-x_1}{x_0-x_1})^2y'_0+(x-x_1)(\frac{x-x_0}{x_1-x_0})^2y'_1$$

# 三次样条插值

实际生活中，遇到三点做插值的情况很多，但是无论Lagrange、Newton抑或是分段插值，其光滑度比较差。
分段样条插值则解决了光滑度的问题，即其二阶导数连续，致使了更加平滑的插值问题的解决。

分段样条插值，本质上是一组三次多项式插值，经过条件处理得到的平滑分段插值Spline。
$$S(x)=
\begin{cases}
a_{11}x^3+a_{12}x^2+a_{13}x+a_{14}, x\in[x_0,x_1)\\
a_{21}x^3+a_{22}x^2+a_{23}x+a_{24}, x\in[x_1,x_2)\\
\cdots

\end{cases}
$$
其中如果点序列为$[x_0,x_1,\cdots,x_n]$的话，会构造出$n$个三次函数，共需要$4n$个参数

参数条件

| $插值条件$          | $n+1$             |
| --------------- | ----------------- |
| $光滑条件（左导数=右导数）$ | $n-1+2n-2(一阶，2阶)$ |
| $边界条件$          | $2$               |
通过上述条件可以得到共$4n$个方程，故可以解出$4n$个参数
其中边界条件一般为：

| $周期边界$ | $f'(x_n)=f'(x_0)$   |
| ------ | ------------------- |
| $默认边界$ | $f'(x_n)=f'(x_0)=0$ |
| $固定边界$ | $f'(x_n),f'(x_0)$   |

而在Hermite插值中，基于两点三次的条件，可以有
$$
\mathbf{h} =
\begin{bmatrix}
h_0 \\
h_1 \\
\vdots \\
h_{n-1}
\end{bmatrix}, \quad
h_i = x_{i+1} - x_i
$$
这个是新的节点长度序列，后面则有差商序列->反映一阶导与二阶导的连续：
$$\mathbf{D}=
\begin{bmatrix}
0 \\
6 \cdot \dfrac{f[x_2, x_1] - f[x_1, x_0]}{h_0 + h_1} \\
\vdots \\
6 \cdot \dfrac{f[x_n, x_{n-1}] - f[x_{n-1}, x_{n-2}]}{h_{n-2} + h_{n-1}} \\
0
\end{bmatrix}$$
系数序列
$$A=
\begin{bmatrix}
1 & 0 &  &  &  & 0 \\
\mu_1 & 2 & \lambda_1 &  &  &  \\
 & \mu_2 & 2 & \lambda_2 &  &  \\
 &  & \ddots & \ddots & \ddots &  \\
 &  &  & \mu_{n-1} & 2 & \lambda_{n-1} \\
0 &  &  &  & 0 & 1
\end{bmatrix}

$$

其中\[
$$\mu_i = \frac{h_{i-1}}{h_{i-1} + h_i}, \quad \lambda_i = \frac{h_i}{h_{i-1} + h_i}$$
则有公式：
$$
A \cdot \mathbf{M} = \mathbf{D}
,\mathbf{M} =
\begin{bmatrix}
M_0 \\
M_1 \\
\vdots \\
M_n
\end{bmatrix}
$$
则就有：
$$S_i(x) =
\frac{M_{i+1}}{6h_i}(x - x_i)^3 +
\frac{M_i}{6h_i}(x_{i+1} - x)^3 +
\left( \frac{y_{i+1}}{h_i} - \frac{M_{i+1}h_i}{6} \right)(x - x_i) +
\left( \frac{y_i}{h_i} - \frac{M_i h_i}{6} \right)(x_{i+1} - x)$$
[[Hermite 插值]]
[[插值法]]